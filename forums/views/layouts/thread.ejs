<%
    const mappedCategories = {};
    data.categories.forEach((category, index) => {
        mappedCategories[category._id.toString()] = index;
    });
%>
<%- include('../fragments/header') %>
<%- include('../fragments/sidebar') %>
<%
    var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
%>

            <content>
                <thread-header>
                    <h1><%= data.thread.title %></h1>
                    <categories>
<%
    for(const category of data.thread.categories){
%>
                        <a href='/c/<%= data.categories[mappedCategories[category]].slug %>'><span class='<%= data.categories[mappedCategories[category]].slug %>'></span><%= data.categories[mappedCategories[category]].title %></a>
<%
    }
%>
                    </categories>
                </thread-header>

                <comments>
                    <comment>
                        <img src='https://avatars.githubusercontent.com/u/20123198?v=4'>
    
                        <comment-inner>
                            <comment-header>
                                <h3><%= data.thread.user.username %></h3>
                                <date><% const date = new Date(data.thread.created); %><%= months[date.getUTCMonth()]+' '+date.getUTCDate()+', '+date.getFullYear() %></date>
                                <button>
                                    <svg viewBox='0 0 24 24'>
                                        <path d='M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z' />
                                    </svg>
                                </button>
                            </comment-header>
                            <preview>
                                <%- data.thread.content %>
                            </preview>
                        </comment-inner>
                    </comment>
<%
    for(const comment of data.thread.comments){
%>
                    <comment>
                        <img src='https://avatars.githubusercontent.com/u/20123198?v=4'>

                        <comment-inner>
                            <comment-header>
                                <h3><%= comment.user.username %></h3>
                                <date><% const date = new Date(comment.created); %><%= months[date.getUTCMonth()]+' '+date.getUTCDate()+', '+date.getFullYear() %></date>
                                <button>
                                    <svg viewBox='0 0 24 24'>
                                        <path d='M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z' />
                                    </svg>
                                </button>
                            </comment-header>
                            <preview>
                                <%- comment.content %>
                            </preview>
                        </comment-inner>
                    </comment>
<%
    }
%>
                </comments>
<%
    if(isSignedIn){
%>
                <editor>
                    <input id='<% const writeId = uniqid(); %><%= writeId %>' name='editor-radio' radio='editor-write' type='radio' checked>
                    <input id='<% const previewId = uniqid(); %><%= previewId %>' name='editor-radio' radio='editor-preview' type='radio'>
                    <editor-header>
                        <label name='editor-write' for='<%= writeId %>'>Write</label>
                        <label name='editor-preview' for='<%= previewId %>'>Preview</label>
                        <filler></filler>
                        <button id='button-bold'>
                            <svg viewBox='0 0 24 24'>
                                <path d='M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z' />
                            </svg>
                        </button>
                        <button id='button-italic'>
                            <svg viewBox='0 0 24 24'>
                                <path d='M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z' />
                            </svg>
                        </button>
                        <button id='button-link'>
                            <svg viewBox='0 0 24 24'>
                                <path d='M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z' />
                            </svg>
                        </button>
                        <button id='button-quote'>
                            <svg viewBox='0 0 24 24'>
                                <path d='M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z' />
                            </svg>
                        </button>
                        <button id='button-code'>
                            <svg viewBox='0 0 24 24'>
                                <path d='M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z' />
                            </svg>
                        </button>
                        <button id='button-list'>
                            <svg viewBox='0 0 24 24'>
                                <path d='M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z' />
                            </svg>
                        </button>
                        <button id='button-num-list'>
                            <svg viewBox='0 0 24 24'>
                                <path d='M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z' />
                            </svg>
                        </button>
                    </editor-header>
                    <textarea placeholder='Write a comment using Markdown.'></textarea>
                    <preview></preview>
                </editor>
<%
    }
%>
            </content>

<%- include('../fragments/footer') %>